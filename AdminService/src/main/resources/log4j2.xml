<?xml version="1.0" encoding="UTF-8"?>
<Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="https://logging.apache.org/xml/ns"
  xsi:schemaLocation="
   https://logging.apache.org/xml/ns
   https://logging.apache.org/xml/ns/log4j-config-2.xsd">
  
  <Appenders>
    <File name="FILE"
      fileName="target/logs.json">
      <PatternLayout pattern="%d{ISO8601} [%t] %-5p %c{1} - %m%n"/>
    </File>
    <RollingFile name="RollingFile" fileName="logs/file.log" filePattern="logs/file-%d{yyyy-MM-dd}.log">
      <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger - %msg%n"/>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="10 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="30"/>
    </RollingFile>

    <RollingFile name="UserLogs" fileName="logs/user-logs.json" filePattern="logs/file-%d{yyyy-MM-dd}.json">
      <JsonTemplateLayout eventTemplateUri="classpath:EcsLayout.json"/>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="10 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="30"/>
    </RollingFile>

    <RollingFile name="DocumentLogs" fileName="logs/doc-logs.json" filePattern="logs/file-%d{yyyy-MM-dd}.json">
      <JsonTemplateLayout eventTemplateUri="classpath:EcsLayout.json"/>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="10 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="30"/>
    </RollingFile>
  </Appenders>
  
  <Loggers>
    <Logger name="com.Anagrafe" level="debug">
      <AppenderRef ref="FILE"/>
      <AppenderRef ref="RollingFile"/>
    </Logger>
    <Root level="INFO">
      <AppenderRef ref="FILE"/>
      <AppenderRef ref="RollingFile"/>
    </Root>

    <Logger name="com.Anagrafe.users" level="info" additivity="false">
      <AppenderRef ref="UserLogs"/>
    </Logger>

    <Logger name="com.Anagrafe.docs" level="info" additivity="false">
      <AppenderRef ref="DocumentLogs"/>
    </Logger>
  </Loggers>

</Configuration>
